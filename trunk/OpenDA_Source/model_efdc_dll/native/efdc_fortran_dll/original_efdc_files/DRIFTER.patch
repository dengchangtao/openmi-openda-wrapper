Index: DRIFTER.f90
===================================================================
--- DRIFTER.f90	(revision 3544)
+++ DRIFTER.f90	(working copy)
@@ -28,7 +28,7 @@
   REAL(RKD) ::KDZ1,KDZ2,KDZ3,KDZ4
   REAL(RKD) ::U1NP,V1NP,W1NP,U2NP,V2NP,W2NP
   REAL(RKD) ::ZSIG
-  REAL, STATIC::TIMENEXT, PMC
+  REAL, SAVE ::TIMENEXT, PMC
   CHARACTER*80 TITLE,METHOD 
 
 !{GEOSR, OIL, CWCHO, 101104 
@@ -63,9 +63,9 @@
   ENDIF
 !}
     ! *** MAKE SURE THE FILE IS NEW
-    OPEN(ULGR,FILE='EE_DRIFTER.OUT',STATUS='UNKNOWN',FORM='BINARY')  
+    OPEN(ULGR,FILE='EE_DRIFTER.OUT',STATUS='UNKNOWN',ACCESS='STREAM')  
     CLOSE(ULGR,STATUS='DELETE')
-    OPEN(ULGR,FILE='EE_DRIFTER.OUT',ACTION='WRITE',FORM='BINARY')  
+    OPEN(ULGR,FILE='EE_DRIFTER.OUT',ACTION='WRITE',ACCESS='STREAM')  
     JSPD=0  
     VER=101
     WRITE(ULGR) VER
@@ -260,7 +260,7 @@
   !        LA_BEGTI, LA_ENDTI, LA_FREQ,LANDT
   INTEGER(4)::NP,I,J,K
   REAL(RKD) ::XC(4),YC(4),AREA2,RANVAL
-  REAL(8),EXTERNAL::DRAND   !IT NEEDS THIS STATEMENT IN CASE OF IMPLICIT NONE
+  !REAL(8),EXTERNAL::RAND   !IT NEEDS THIS STATEMENT IN CASE OF IMPLICIT NONE
     
   OPEN(ULOC,FILE='DRIFTER.INP',ACTION='READ')
   CALL READSTR(ULOC)
@@ -289,7 +289,7 @@
     ENDDO
   ENDIF
   CLOSE(ULOC)
-  IF(LA_PRAN>0) RANVAL = DRAND(1)
+  IF(LA_PRAN>0) RANVAL = RAND(1)
   RETURN
   999 STOP 'DRIFTER.INP READING ERROR!'
 END SUBROUTINE
@@ -297,7 +297,7 @@
 SUBROUTINE READSTR(UINP)   !******************************************************************
   INTEGER(4),INTENT(IN)::UINP
   CHARACTER(200)::STR
-  DO WHILE (1)
+  DO WHILE (.TRUE.)
     READ(UINP,'(A)') STR
     STR=ADJUSTL(STR)
     IF (STR(1:1).NE.'*') THEN
@@ -668,7 +668,7 @@
 
 SUBROUTINE RANDCAL(L,K,NP)   ! ***************************************************************
   INTEGER,INTENT(IN)::L,K,NP
-  REAL(8),EXTERNAL::DRAND
+  !REAL(8),EXTERNAL::RAND
   REAL(RKD)::COEF
   IF (LA_PRAN==1.OR.LA_PRAN==3) THEN
     IF (LA_DIFOP==0) THEN
@@ -676,8 +676,8 @@
     ELSE
       COEF = SQRT(2*LA_HORDIF*DT)
     ENDIF
-    XLA(NP) = XLA(NP) + (2*DRAND(0)-1)*COEF
-    YLA(NP) = YLA(NP) + (2*DRAND(0)-1)*COEF
+    XLA(NP) = XLA(NP) + (2*RAND(0)-1)*COEF
+    YLA(NP) = YLA(NP) + (2*RAND(0)-1)*COEF
   ENDIF
   IF (LA_PRAN.GE.2.AND.LA_ZCAL==1) THEN
     IF (LA_DIFOP==0) THEN
@@ -685,7 +685,7 @@
     ELSE
       COEF = SQRT(2*LA_VERDIF*DT)
     ENDIF
-    ZLA(NP) = ZLA(NP)+ (2*DRAND(0)-1)*COEF
+    ZLA(NP) = ZLA(NP)+ (2*RAND(0)-1)*COEF
   ENDIF
 END SUBROUTINE
 
@@ -800,7 +800,7 @@
   XC(6) = XC(2)
   YC(6) = YC(2)
   CALL AREACAL(XC,YC,AREA2)
-  IF (ABS(AREA2-AREA(L)<=1D-6)) THEN
+  IF (ABS(AREA2-AREA(L))<=1D-6) THEN
     INSIDE=.TRUE.
   ELSE 
     INSIDE=.FALSE.
@@ -878,7 +878,7 @@
  XCOR = 0
  YCOR = 0
  AREA = 0
- DO WHILE(1)
+ DO WHILE(.TRUE.)
    READ(UCOR,*,END=100,ERR=998) I,J,(XCOR(LIJ(I,J),K),YCOR(LIJ(I,J),K),K=1,4)
    XC(1:4) = XCOR(LIJ(I,J),1:4)
    YC(1:4) = YCOR(LIJ(I,J),1:4)
@@ -894,4 +894,4 @@
  998 STOP 'CORNERS.INP READING ERROR!'
  END SUBROUTINE
  
-END MODULE
\ No newline at end of file
+END MODULE

